postgresql:
  image: index.alauda.cn/alauda/postgres:9.3
  expose:
    - "5432"
  volumes:
    - /var/lib/postgresql/data:10
  environment:
    - POSTGRES_USER=gitlab
    - POSTGRES_PASSWORD=password
    - POSTGRES_DB=gitlabhq_production
gitlab:
  image: index.alauda.cn/alauda/gitlab:7.9.4
  links:
    - redis:redis
    - postgresql:postgresql
  ports:
    - "80"
    - "22"
  environment:
    - DB_HOST: $POSTGRESQL_PORT_5432_TCP_ADDR
    - DB_PORT: $POSTGRESQL_PORT_5432_TCP_PORT
    - REDIS_HOST: $REDIS_PORT_6379_TCP_ADDR
    - REDIS_PORT: $REDIS_PORT_6379_TCP_PORT
    - DB_NAME=gitlabhq_production
    - DB_PASS=password
    - DB_TYPE=postgres
    - DB_USER=gitlab
    - GITLAB_SSH_PORT=10022
  volumes:
    - /home/git/data:10
  size: L
redis:
  image: index.alauda.cn/alauda/redis:2.8
  expose:
    - "6379"
  volumes:
    - /data:10
